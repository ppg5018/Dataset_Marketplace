{% extends "base.html" %}

{% block content %}
<div class="container" style="padding: 3rem 2rem;">

    <!-- Hero Section -->
    <div class="hero" style="min-height: auto; margin-bottom: 3rem;">
        <h1 class="animate-fade-in" style="font-size: 3.5rem;">üï∏Ô∏è Web Scraper</h1>
        <p class="animate-fade-in delay-1" style="max-width: 700px; margin: 0 auto;">
            Extract data from any website and convert it into a dataset
        </p>
    </div>

    <!-- Scraper Form -->
    <div class="card glass-panel scroll-reveal" style="max-width: 900px; margin: 0 auto;">

        <!-- URL Input Section -->
        <div class="form-group"
            style="background: var(--holographic); padding: 2rem; border-radius: 16px; margin-bottom: 2rem;">
            <h3 style="color: white; margin-top: 0; margin-bottom: 1rem;">
                <i class="fas fa-link"></i> Enter Website URL
            </h3>
            <input type="url" id="scrape-url" placeholder="https://example.com/data"
                style="width: 100%; padding: 1rem; font-size: 1.1rem; border: none; border-radius: 12px; background: white; color: #0A0E27;">

            <div style="margin-top: 1.5rem; display: flex; gap: 1rem; align-items: center;">
                <button onclick="startScrape()" class="btn" style="background: white; color: #667eea; border: none;">
                    <i class="fas fa-play"></i> Start Scraping
                </button>
                <span id="scrape-status" style="color: white;"></span>
            </div>
        </div>

        <!-- Method Selection -->
        <div class="form-group" style="margin-bottom: 2rem;">
            <label style="font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: block;">
                <i class="fas fa-cog"></i> Scraping Method
            </label>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div class="method-card" onclick="selectMethod('table')" data-method="table">
                    <i class="fas fa-table"></i>
                    <div style="font-weight: 600;">Auto-Detect Tables</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Extract HTML tables</div>
                </div>
                <div class="method-card" onclick="selectMethod('simple')" data-method="simple">
                    <i class="fas fa-file-alt"></i>
                    <div style="font-weight: 600;">Simple Text</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Extract all text content</div>
                </div>
                <div class="method-card" onclick="selectMethod('custom')" data-method="custom">
                    <i class="fas fa-code"></i>
                    <div style="font-weight: 600;">Custom Selectors</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Use CSS selectors</div>
                </div>
            </div>
        </div>

        <!-- Custom Selectors (Hidden by default) -->
        <div id="custom-selectors" style="display: none; margin-bottom: 2rem;">
            <label style="font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: block;">
                CSS Selectors (Optional)
            </label>
            <div id="selector-inputs">
                <div style="display: flex; gap: 1rem; margin-bottom: 0.5rem;">
                    <input type="text" placeholder="Column Name" class="selector-name"
                        style="flex: 1; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-secondary);">
                    <input type="text" placeholder="CSS Selector (e.g., .product-title)" class="selector-value"
                        style="flex: 2; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-secondary);">
                </div>
            </div>
            <button onclick="addSelector()" class="btn btn-secondary" style="margin-top: 0.5rem;">
                <i class="fas fa-plus"></i> Add Selector
            </button>
        </div>

        <!-- Preview Section -->
        <div id="preview-section" style="display: none; margin-top: 2rem;">
            <h3><i class="fas fa-eye"></i> Preview</h3>
            <div id="preview-stats" style="margin-bottom: 1rem; font-size: 0.95rem; color: var(--text-secondary);">
            </div>
            <div id="preview-table"
                style="overflow-x: auto; max-height: 400px; border: 1px solid var(--border); border-radius: 12px;">
            </div>

            <!-- Save Form -->
            <div id="save-form"
                style="margin-top: 2rem; padding: 2rem; background: var(--bg-secondary); border-radius: 12px;">
                <h4>Save as Dataset</h4>
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="dataset-title" placeholder="My Scraped Dataset"
                        style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-card);">
                </div>
                <div class="form-group">
                    <label>Description (Optional)</label>
                    <textarea id="dataset-description" rows="3" placeholder="Describe this dataset..."
                        style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-card);"></textarea>
                </div>
                <div class="form-group">
                    <label>Price ($)</label>
                    <input type="number" id="dataset-price" value="0" min="0" step="0.01"
                        style="width: 200px; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-card);">
                </div>
                <button onclick="saveDataset()" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Dataset
                </button>
            </div>
        </div>
    </div>

</div>

<style>
    .method-card {
        padding: 1.5rem;
        background: var(--bg-secondary);
        border: 2px solid var(--border);
        border-radius: 12px;
        text-align: center;
        cursor: pointer;
        transition: var(--transition-smooth);
    }

    .method-card:hover {
        transform: translateY(-5px);
        border-color: var(--electric-blue);
        box-shadow: var(--glow-cyan);
    }

    .method-card.active {
        background: var(--holographic);
        color: white;
        border-color: transparent;
        box-shadow: var(--glow-purple);
    }

    .method-card i {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        display: block;
    }

    #preview-table table {
        width: 100%;
        border-collapse: collapse;
    }

    #preview-table th,
    #preview-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid var(--border);
    }

    #preview-table th {
        background: var(--bg-secondary);
        font-weight: 600;
        position: sticky;
        top: 0;
    }

    #preview-table tr:hover {
        background: var(--bg-secondary);
    }
</style>

<script src="{{ url_for('static', filename='js/scraper.js') }}"></script>
{% endblock %}